!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(function(){try{return require("vuex-cache")}catch(e){}}()):"function"==typeof define&&define.amd?define(["vuex-cache"],t):"object"==typeof exports?exports.vuexModuleMaker=t(function(){try{return require("vuex-cache")}catch(e){}}()):e.vuexModuleMaker=t(e["vuex-cache"])}(self,(e=>(()=>{var t={643:e=>{e.exports=!1},113:t=>{"use strict";if(void 0===e){var n=new Error("Cannot find module 'undefined'");throw n.code="MODULE_NOT_FOUND",n}t.exports=e},199:()=>{}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";function e(t,n){return t.length?Object.prototype.hasOwnProperty.call(n,t[0])?e(t.slice(1),n[t[0]]):null:n}function t(e){return e.replace(/([A-Z])/g,(function(e){return"_"+e})).toUpperCase()}r.r(o),r.d(o,{VuexModuleMaker:()=>X,actionConfigs:()=>i,createChannel:()=>V,getChannel:()=>z});const n={peerDependency:"You must install vuex-cache to be able to use the cache."},i={common:{list:{hasMetadata:!0,append:!0},create:{appendAlways:!0},edit:{editing:!0}}};Promise.resolve(!1);Promise.resolve(!0);var a=Promise.resolve();function s(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function c(){return Math.random().toString(36).substring(2)}var u=0,d=0;function l(){var e=(new Date).getTime();return e===u?1e3*e+ ++d:(u=e,d=0,1e3*e)}var f="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);const h={create:function(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),a}catch(e){return Promise.reject(e)}},canBeUsed:function(){if(f&&"undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1},type:"native",averageResponseTime:function(){return 150},microSeconds:l};var p=function(){function e(e){this.ttl=e,this.map=new Map,this._to=!1}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.add=function(e){var t=this;this.map.set(e,m()),this._to||(this._to=!0,setTimeout((function(){t._to=!1,function(e){for(var t=m()-e.ttl,n=e.map[Symbol.iterator]();;){var r=n.next().value;if(!r)return;var o=r[0];if(!(r[1]<t))return;e.map.delete(o)}}(t)}),0))},e.prototype.clear=function(){this.map.clear()},e}();function m(){return(new Date).getTime()}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var b="messages",g={durability:"relaxed"};function y(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function w(e){e.commit&&e.commit()}function _(e){e.closed||P(e).then((function(){return s(e.options.idb.fallbackInterval)})).then((function(){return _(e)}))}function P(e){return e.closed?a:e.messagesCallback?function(e,t){var n=e.transaction(b,"readonly",g),r=n.objectStore(b),o=[],i=IDBKeyRange.bound(t+1,1/0);if(r.getAll){var a=r.getAll(i);return new Promise((function(e,t){a.onerror=function(e){return t(e)},a.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,a){var s=function(){try{return i=IDBKeyRange.bound(t+1,1/0),r.openCursor(i)}catch(e){return r.openCursor()}}();s.onerror=function(e){return a(e)},s.onsuccess=function(r){var i=r.target.result;i?i.value.id<t+1?i.continue(t+1):(o.push(i.value),i.continue()):(w(n),e(o))}}))}(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),a})):a}const C={create:function(e,t){return t=v(t),function(e){var t="pubkey.broadcast-channel-0-"+e,n=y().open(t);return n.onupgradeneeded=function(e){e.target.result.createObjectStore(b,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){n.onerror=function(e){return t(e)},n.onsuccess=function(){e(n.result)}}))}(e).then((function(n){var r={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:c(),eMIs:new p(2*t.idb.ttl),writeBlockPromise:a,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){r.closed=!0,t.idb.onclose&&t.idb.onclose()},_(r),r}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,P(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var r={uuid:t,time:(new Date).getTime(),data:n},o=e.transaction([b],"readwrite",g);return new Promise((function(e,t){o.oncomplete=function(){return e()},o.onerror=function(e){return t(e)},o.objectStore(b).add(r),w(o)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(0,10,Math.floor(11*Math.random()+0))&&(t=e.db,n=e.options.idb.ttl,function(e,t){var n=(new Date).getTime()-t,r=e.transaction(b,"readonly",g),o=r.objectStore(b),i=[];return new Promise((function(e){o.openCursor().onsuccess=function(t){var o=t.target.result;if(o){var a=o.value;if(!(a.time<n))return w(r),void e(i);i.push(a),o.continue()}else e(i)}}))}(t,n).then((function(e){return function(e,t){var n=e.transaction([b],"readwrite",g).objectStore(b);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(t,e.map((function(e){return e.id})))})))})),e.writeBlockPromise},canBeUsed:function(){return!f&&!!y()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:l};function k(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function M(e){return"pubkey.broadcastChannel-"+e}function A(){if(f)return!1;var e=k();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}const S={create:function(e,t){if(t=v(t),!A())throw new Error("BroadcastChannel: localstorage cannot be used");var n=c(),r=new p(t.localstorage.removeTimeout),o={channelName:e,uuid:n,eMIs:r};return o.listener=function(e,t){var i=M(e),a=function(e){var t;e.key===i&&(t=JSON.parse(e.newValue),o.messagesCallback&&t.uuid!==n&&t.token&&!r.has(t.token)&&(t.data.time&&t.data.time<o.messagesCallbackTime||(r.add(t.token),o.messagesCallback(t.data))))};return window.addEventListener("storage",a),a}(e),o},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){s().then((function(){var r=M(e.channelName),o={token:c(),time:(new Date).getTime(),data:t,uuid:e.uuid},i=JSON.stringify(o);k().setItem(r,i);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=r,a.newValue=i,window.dispatchEvent(a),n()}))}))},canBeUsed:A,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:l};var I=l,O=new Set;const x={create:function(e){var t={name:e,messagesCallback:null};return O.add(t),t},close:function(e){O.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(O).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:I};var j=[h,C,S],E=new Set,T=0,D=function(e,t){this.id=T++,E.add(this),this.name=e,this.options=v(t),this.method=function(e){var t=[].concat(e.methods,j).filter(Boolean);if(e.type){if("simulate"===e.type)return x;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||f||(t=t.filter((function(e){return"idb"!==e.type})));var r=t.find((function(e){return e.canBeUsed()}));if(r)return r;throw new Error("No useable method found in "+JSON.stringify(j.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,function(e){var t,n=e.method.create(e.name,e.options);(t=n)&&"function"==typeof t.then?(e._prepP=n,n.then((function(t){e._state=t}))):e._state=n}(this)};function L(e,t,n){var r={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:a).then((function(){var t=e.method.postMessage(e._state,r);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function B(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function N(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&B(e)){var t=function(t){e._addEL[t.type].forEach((function(e){var n=e.time-1e5;t.time>=n&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function R(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!B(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}D._pubkey=!0,D.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return L(this,"message",e)},postInternal:function(e){return L(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};R(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,N(this,"message",t)):this._onML=null},addEventListener:function(e,t){N(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){R(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){E.delete(this),this.closed=!0;var t=this._prepP?this._prepP:a;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var q=r(643),U=r.n(q);const J={add:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}}};var F=r(199),W=r.n(F);U()&&W(),new Set;var G;var V=e=>{var{channelName:t=""}=e;return e=>{(G=new D("@lianulloa/vuex-module-maker/"+t)).onmessage=t=>{var{type:n,payload:r}=t;"dispatch"===n&&e.dispatch(r)}}},z=()=>G;function K(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){K(i,r,o,a,s,"next",e)}function s(e){K(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X{constructor(e){var{state:t={},getters:n={},mutations:o={},actions:i={}}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{namespaced:!0,moduleName:""};this._state="function"==typeof t?t():t,this._getters=[...Object.keys("function"==typeof t?t():t),n],this._actions=i,this.options=a,this._mutations=[...this._getDefaultMutations(this._state,i),o],this._cachedActions={};try{this.vuexCache=r(113)}catch(e){this.vuexCache={}}}getModule(){return Z({state:this._state,getters:this.buildGetters(),mutations:this.buildMutations(),actions:this.buildActions()},this.options)}_getDefaultMutations(e,t){var n=new Set(Object.keys(e)),r=new Set(Object.values(t).filter((e=>"object"==typeof e&&!e.mutation)).map((e=>e.attr)));for(var o of r)n.add(o);return n}addGetter(e){return this._getters.push(e),this}addMutation(e){return this._mutations.push(e),this}addAction(e){var{actionName:t,action:n}=e;return"object"!=typeof n||n.mutation||this._mutations.filter((e=>"string"==typeof e)).some((e=>e===n.attr))||this._mutations.push(n.attr),this._actions[t]=n,this}buildGetters(){var t,n={};for(var r of this._getters)if("string"==typeof r){t=r.split(".");var o=e.bind(null,t);n[t[t.length-1]]=o}else if("object"==typeof r)for(var i of Object.entries(r))if("string"==typeof i[1]){t=r.split(".");var a=e.bind(null,t);n[i[0]]=a}else"function"==typeof i[1]&&(n[i[0]]=i[1]);return n}buildMutations(){var e={},n=function(n){if("string"==typeof n)e["SET_"+t(n)]=(e,t)=>e[n]=t;else if("object"==typeof n){var r=function(t){"string"==typeof t[1]?e[t[0]]=(e,n)=>e[t[1]]=n:"function"==typeof t[1]&&(e[t[0]]=t[1])};for(var o of Object.entries(n))r(o)}};for(var r of this._mutations)n(r);return e}buildActions(){var e={};for(var t in this._actions)if("function"==typeof this._actions[t])e[t]=this._actions[t];else if("object"==typeof this._actions[t]){var r=this._actions[t];!r.cacheAPIRequestIn&&!r.cacheActionToDelete||this.vuexCache.cacheAction||(delete r.cacheAPIRequestIn,delete r.cacheActionToDelete,console.warn("".concat("[Vuex-Module-Maker]:"," ").concat(n.peerDependency,"\nCheck '").concat(t,"' action"))),r.cacheAPIRequestIn&&(e[r.cacheAPIRequestIn]=this._createFetchAction(r),e[this._getClearActionName(r.cacheAPIRequestIn)]=this._createClearCacheAction(r.cacheAPIRequestIn)),e[t]=this.buildAction(r)}return e}buildAction(e){var n=this,r=(r,o)=>{var{commit:i,state:a,cache:s}=r,c=e.appendAlways||e.append&&(null==o?void 0:o.append),u=(null==o?void 0:o.refresh)&&e.editingRefreshService;return o&&delete o.append,new Promise(function(){var r=Q((function*(r,d){try{if(s&&e.cacheActionToDelete){n._deleteCacheAction(s,e.cacheActionToDelete);var l=z();l&&l.postMessage({type:"dispatch",payload:"".concat(n.options.moduleName,"/").concat(n._getClearActionName(e.cacheActionToDelete))})}var f=s&&e.cacheAPIRequestIn?yield n._cacheAction(s,e.cacheAPIRequestIn,o):yield n._sendRequest(o,e);e.hasMetadata&&i("SET_TOTAL_"+t(e.attr),f.metadata.total),(e.attr||e.mutation)&&i(e.mutation?e.mutation:"SET_"+t(e.attr),yield n._prepareDataToCommit(f,Z(Z({},e),{},{append:c,state:a,refresh:u}))),r(f)}catch(e){d(e)}}));return function(e,t){return r.apply(this,arguments)}}())};return e.cacheAPIRequestIn||e.cacheActionToDelete?this.vuexCache.cacheAction(r):r}_prepareDataToCommit(e,t){return Q((function*(){var n=e;if(t.hasMetadata&&(n=e.data),t.append)return Array.prototype.concat(t.state[t.attr],n);if(t.editing){var r=[...t.state[t.attr]],o=r.findIndex((e=>e.id===n.id));if(t.refresh){var i=yield t.editingRefreshService(n.id);n=i.data}return r[o]=n,r}return n}))()}_sendRequest(e,t){return Q((function*(){return t.spreadServiceArgs?(yield t.service(...e)).data:t.editing?(yield t.service(e.id,e.body)).data:(yield t.service(e)).data}))()}_createFetchAction(e){var t=this;return(n,r)=>new Promise(function(){var n=Q((function*(n,o){try{n(yield t._sendRequest(r,e))}catch(e){o(e)}}));return function(e,t){return n.apply(this,arguments)}}())}_createClearCacheAction(e){return this.vuexCache.cacheAction((t=>{this._deleteCacheAction(t.cache,e)}))}_cacheAction(e,t,n){var r=n?JSON.stringify(n):"";return this._cachedActions[t]?this._cachedActions[t].add(r):this._cachedActions[t]=new Set([r]),e.dispatch(t,n)}_deleteCacheAction(e,t){if(this._cachedActions[t]){for(var n of this._cachedActions[t]){var r=""!==n?JSON.parse(n):void 0;e.has(t,r)&&e.delete(t,r)}this._cachedActions[t]=new Set}}_getClearActionName(e){var[,t]=e.split("/");return"clear".concat(t[0].toUpperCase()+t.slice(1))}}})(),o})()));
//# sourceMappingURL=main.js.map